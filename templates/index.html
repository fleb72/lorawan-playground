<!DOCTYPE html>
    <html lang="fr">    
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>MÃ©tÃ©o Le Mans</title>
        <link rel="stylesheet" href="/static/style.css">
	
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/luxon@3/build/global/luxon.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon"></script>
      </head>

      <body>
        <div class="container">
          <h1>Le Mans - DerniÃ¨res mesures</h1>
          <p>ğŸ•’ Date/heure : <span id="formatted_time"></span></p>
          <p>ğŸŒ¡ï¸ TempÃ©rature : <span id="temperature"></span> Â°C</p>
          <p>ğŸ’§ HumiditÃ© : <span id="humidity"></span> %</p>

	  <p style="font-size: 0.7em; color: #666; text-align: justify; margin-top: 20px;">
	    <strong>ConfidentialitÃ©&nbsp;:</strong>&nbsp;Cette page ne dÃ©pose aucun cookie, ne collecte aucune donnÃ©e personnelle, et ne rÃ©alise aucun suivi utilisateur. Aucune information nâ€™est enregistrÃ©e ou utilisÃ©e Ã  des fins dâ€™identification.
	  </p>
	</div>

	<div style="height: 250px;">  <canvas id="tempChart"></canvas>  </div>				
	<div style="height: 250px;">   <canvas id="humidityChart"></canvas>  </div>		
	
				
        <script src="/static/graph-common.js"> </script>	
				

	<script>
		function fetchLatestData() {
  			fetch("/api/latest-data")
                                .then(response => {
                                  if (!response.ok) {
                                    throw new Error("RÃ©ponse HTTP non OK: " + response.status);
                                  }
                                  return response.json();
                                })
    				.then(data => {
      				  // Met Ã  jour les Ã©lÃ©ments HTML et les graphes
      				  document.getElementById("temperature").textContent = data.temperature;
      				  document.getElementById("humidity").textContent = data.humidity;
      				  document.getElementById("formatted_time").textContent = data.formatted_time;

                                  drawChart(
                                    'tempChart',
                                    data.points_temperature,
                                    'TempÃ©rature (Â°C)',
                                    'rgba(255, 99, 132, 1)',
                                    'TempÃ©rature (Â°C)',
                                    "Moyenne horaire de la tempÃ©rature sur les 12 derniÃ¨res heures"
                                  );

                                  drawChart(
                                    'humidityChart',
                                    data.points_humidity,
                                    'HumiditÃ© (%RH)',
                                    'rgba(99, 132, 255, 1)',
                                    'HumiditÃ© (%RH)',
                                    "Moyenne horaire de l'humiditÃ© sur les 12 derniÃ¨res heures"
                                  );

    				})
    				.catch(error => {
      					console.error("Erreur lors du chargement des donnÃ©es :", error);
    				});
		}

		// Appel initial
		fetchLatestData();

		// RafraÃ®chissement
		setInterval(fetchLatestData, {{ interval }} * 1000);
	</script>



      </body>
    </html>
